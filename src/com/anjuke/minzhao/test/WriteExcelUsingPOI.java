package com.anjuke.minzhao.test;

import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.IOException;
import java.io.InputStream;

import org.apache.poi.hssf.usermodel.HSSFWorkbook;
import org.apache.poi.ss.usermodel.Cell;
import org.apache.poi.ss.usermodel.Row;
import org.apache.poi.ss.usermodel.Sheet;
import org.apache.poi.ss.usermodel.Workbook;
import org.apache.poi.ss.usermodel.WorkbookFactory;

public class WriteExcelUsingPOI {

    /**
     * @param args
     * @throws Exception 
     */
    public static void main(String[] args) throws Exception {
        // TODO Auto-generated method stub
        POITest.createWorkBook(); 
        System.out.println("it's over");
        //POITest.readWorkBook(); 
    }
    public static class POITest{
        public static void createWorkBook() throws IOException{
          //创建excel工作簿 
            Workbook wb = new HSSFWorkbook(); 
            //创建第一个sheet（页），命名为 new sheet 
            Sheet sheet = wb.createSheet("new sheet"); 
            //Row 行 
            //Cell 方格 
            // Row 和 Cell 都是从0开始计数的 
             
            // 创建一行，在页sheet上 
            Row row = sheet.createRow((short) 0); 
            // 在row行上创建一个方格 
            //Cell cell = row.createCell(0); 
            //设置方格的显示 
            //cell.setCellValue(1); 
            row.createCell(0).setCellValue("热词");
            // Or do it on one line. 
            row.createCell(1).setCellValue("排名"); 
            row.createCell(2).setCellValue("权重"); 
            //row.createCell(3).setCellValue(true); 
            for(int i =1;i<=count;i++){
                
            }
            //创建一个文件 命名为workbook.xls 
            FileOutputStream fileOut = new FileOutputStream("workbook.xls"); 
            // 把上面创建的工作簿输出到文件中 
            wb.write(fileOut); 
            //关闭输出流 
            fileOut.close(); 
        
        }
        //使用POI读入excel工作簿文件 
        public static void readWorkBook() throws Exception { 
            // poi读取excel 
            //创建要读入的文件的输入流 
            InputStream inp = new FileInputStream("workbook.xls"); 
             
            //根据上述创建的输入流 创建工作簿对象 
            Workbook wb = WorkbookFactory.create(inp); 
            //得到第一页 sheet 
            //页Sheet是从0开始索引的 
            Sheet sheet = wb.getSheetAt(0); 
            //利用foreach循环 遍历sheet中的所有行 
            for (Row row : sheet) { 
                //遍历row中的所有方格 
                for (Cell cell : row) { 
                    //输出方格中的内容，以空格间隔 
                    System.out.print(cell.toString() + "  "); 
                } 
                //每一个行输出之后换行 
                System.out.println(); 
            } 
            //关闭输入流 
            inp.close(); 
        } 
    }
}
